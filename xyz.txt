here is reduced the code